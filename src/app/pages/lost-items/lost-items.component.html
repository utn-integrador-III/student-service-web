<div class="fondo">
  <h1
    mat-dialog-title
    style="
      text-align: center;
      color: black;
      margin-top: 20px;
      margin-bottom: -10px;
    "
  >
    Modificar Artículo
  </h1>
  <hr />
  <div mat-dialog-content>
    <form [formGroup]="form" (ngSubmit)="onSaveClick()">
      <div class="form-group">
        <mat-label>Nombre</mat-label>
        <input matInput formControlName="name" class="input-field" />
        <mat-error *ngIf="form.get('name').invalid && form.get('name').touched">
          El nombre es requerido.
        </mat-error>
      </div>
      <div class="form-group">
        <mat-label>Descripción</mat-label>
        <textarea
          matInput
          formControlName="description"
          class="input-field"
        ></textarea>
        <mat-error
          *ngIf="
            form.get('description').invalid && form.get('description').touched
          "
        >
          La descripción es requerida.
        </mat-error>
      </div>
      <div class="form-group">
        <mat-label>Selecciona categorías</mat-label>
        <div style="display: flex; flex-direction: column; align-items: center">
          <div
            style="
              display: flex;
              flex-wrap: wrap;
              justify-content: center;
              gap: 10px;
            "
          >
            <mat-checkbox
              *ngFor="let category of categories"
              [checked]="selectedCategories[category.category_name]"
              (change)="
                onCategoryChange(category.category_name, $event.checked)
              "
            >
              <span style="color: #333; margin-top: 8px; font-weight: 500">
                {{ category.category_name }}
              </span>
            </mat-checkbox>
          </div>
          <mat-error
            *ngIf="!getSelectedCategories().length"
            style="
              color: red;
              font-size: 0.875rem;
              text-align: center;
              width: 100%;
            "
          >
            Seleccione al menos una categoría.
          </mat-error>
        </div>
      </div>
      <div class="file-upload-wrapper" style="margin-bottom: 3px">
        <button
          type="button"
          class="file-upload-button"
          (click)="fileInput.click()"
        >
          Select File
        </button>
        <input
          #fileInput
          type="file"
          (change)="onFileSelected($event)"
          style="display: none"
        />
        <span class="file-name">{{ selectedFileName }}</span>
      </div>
      <div
        class="form-group1"
        (drop)="onDrop($event)"
        (dragover)="onDragOver($event)"
        (dragleave)="onDragLeave($event)"
        [class.dragover]="isDragOver"
      >
        <mat-label>Imagen</mat-label>
        <div *ngIf="filePreview" class="image-preview">
          <img [src]="filePreview" alt="Image Preview" />
          <button type="button" class="delete-button" (click)="onDelete()">
            Delete
          </button>
        </div>
        <p *ngIf="!filePreview">
          Drag and drop an image here or click to select
        </p>
      </div>
      <div mat-dialog-actions>
        <button
          type="submit"
          style="background-color: #1b3069; color: aliceblue"
          class="btn btn-secondary btn-lg flex-grow-1 m-1"
          [disabled]="form.invalid"
        >
          Guardar
        </button>
        <button
          type="button"
          style="background-color: #696969; color: aliceblue"
          class="btn btn-lg flex-grow-1 m-1"
          (click)="onNoClick()"
        >
          Cancelar
        </button>
      </div>
    </form>
  </div>
</div>
