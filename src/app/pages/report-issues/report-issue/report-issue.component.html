<div class="titulo">Reporte de averías</div>
<div class="linea-horizontal"></div>
<div class="container-fluid">
  <div class="row">
    <!-- Sección Izquierda: Formulario -->
    <div class="col-md-5">
      <p style="text-align: center; margin-top: 20px; font-size: 20px">
        Reportar problemática
      </p>

      <div class="mb-3">
        <select
          id="labSelect"
          class="form-select inputs"
          [(ngModel)]="selectedLab"
          (ngModelChange)="onLabSelect($event)"
        >
          <option value="" [ngValue]="null">Selecciona un lab</option>
          <option *ngFor="let lab of labs" [ngValue]="lab">
            {{ lab.lab_name }}
          </option>
        </select>

        <p style="text-align: center; margin-top: 20px; font-size: 12px">
          Por favor selecciona la(s) computadora(s)
        </p>

        <div class="row">
          <div class="col-6">
            <div class="image-grid">
              <div
                *ngFor="let image of imageUrlsLeft"
                class="image-container"
                (click)="onImageClick(image)"
              >
                <div class="d-flex flex-column align-items-center">
                  <img
                    [src]="image.imageUrl"
                    alt="Imagen {{ image.number }}"
                    class="computer-image clickable-image"
                  />
                  <span class="image-number mt-3 mb-2 d-block text-center">
                    {{ image.number }}
                  </span>
                </div>
              </div>
            </div>
          </div>
          <div class="col-6">
            <div class="image-grid">
              <div
                *ngFor="let image of imageUrlsRight"
                class="image-container"
                (click)="onImageClick(image)"
              >
                <div class="d-flex flex-column align-items-center">
                  <img
                    [src]="image.imageUrl"
                    alt="Imagen {{ image.number }}"
                    class="computer-image clickable-image"
                  />
                  <span class="image-number mt-3 mb-2 d-block text-center">
                    {{ image.number }}
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="mb-3">
          <input
            placeholder="Seleccione las computadoras"
            type="text"
            class="form-control inputs"
            [(ngModel)]="selectedComputerNumber"
            readonly
          />
        </div>

        <textarea
          style="background-color: #eeeeee"
          class="form-control inputs"
          id="item-descripcion"
          rows="4"
          placeholder="Agrega un comentario sobre el problema"
          [(ngModel)]="description"
          (ngModelChange)="updateCanCreate()"
        ></textarea>

        <button
          type="button"
          style="margin-top: 20px"
          class="btn buttonApertura w-50 mb-5"
          [disabled]="!canCreate"
          [ngClass]="{ 'disabled-button': !canCreate }"
          (click)="createIssue()"
        >
          Agregar comentario
        </button>
      </div>
    </div>

    <!-- Divisor Vertical -->
    <div class="col-md-1 d-flex align-items-stretch">
      <div class="linea-vertical"></div>
    </div>

    <!-- Sección Derecha: Tabla -->
    <div class="col-md-6">
      <div style="text-align: center; font-size: 20px; margin-top: 30px">
        Visualización de comentarios
      </div>

      <div style="margin-top: 20px">
        <table
          mat-table
          [dataSource]="dataSource"
          class="mat-elevation-z8"
          style="width: 100%"
        >
          <ng-container matColumnDef="number">
            <th mat-header-cell *matHeaderCellDef>Computadora</th>
            <td mat-cell *matCellDef="let element">{{ element.number }}</td>
          </ng-container>

          <ng-container matColumnDef="description">
            <th mat-header-cell *matHeaderCellDef>Comentario</th>
            <td mat-cell *matCellDef="let element">
              {{ element.description }}
            </td>
          </ng-container>

          <ng-container matColumnDef="date">
            <th mat-header-cell *matHeaderCellDef>Fecha</th>
            <td mat-cell *matCellDef="let element">{{ element.date }}</td>
          </ng-container>

          <tr
            mat-header-row
            *matHeaderRowDef="displayedColumns"
            style="background-color: #89c1e0; text-align: center; color: white"
          ></tr>

          <tr
            mat-row
            *matRowDef="let row; columns: displayedColumns"
            class="tablaAbajo"
            (click)="onRowClick(row)"
            style="cursor: pointer"
          ></tr>

          <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="3">No hay datos disponibles</td>
          </tr>
        </table>
      </div>
    </div>
  </div>
</div>
